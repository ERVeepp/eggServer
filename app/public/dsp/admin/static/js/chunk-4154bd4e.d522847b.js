(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4154bd4e"],{4343:function(e,t,a){},7514:function(e,t,a){"use strict";var n=a("5ca1"),i=a("0a49")(5),r="find",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),n(n.P+n.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(r)},ad7c:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("New Role")]),e._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.list,border:""}},[a("el-table-column",{attrs:{align:"center",label:"Role ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.id)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"Role Name"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.name)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"Role Parent ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.parent_id)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"Role Status"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-value":"1","inactive-value":"2"},on:{change:function(a){return e.changeRoleStatus(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"Operations"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleEdit(t)}}},[e._v("Role")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.handleDelete(t)}}},[e._v("Delete")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible,title:"edit"===e.dialogType?"Edit Role":"New Role"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{attrs:{model:e.dialogData.data,"label-width":"150px","label-position":"left"}},[a("el-form-item",{attrs:{label:"Name"}},[a("el-input",{attrs:{placeholder:"Role Name",disabled:"edit"===e.dialogType},model:{value:e.dialogData.data.name,callback:function(t){e.$set(e.dialogData.data,"name",t)},expression:"dialogData.data.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"parent_id"}},[a("ChoiceRole",{attrs:{role:e.dialogData.data.parent_id,disabled:"edit"===e.dialogType},on:{"update:role":function(t){return e.$set(e.dialogData.data,"parent_id",t)}}})],1),e._v(" "),"edit"===e.dialogType?a("el-form-item",{attrs:{label:"接口权限"}},[a("div",{},[a("el-input",{staticClass:"w100",attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.dialogData.data.filterApiText,callback:function(t){e.$set(e.dialogData.data,"filterApiText",t)},expression:"dialogData.data.filterApiText"}}),e._v(" "),a("el-tree",{ref:"apitree",staticClass:"permission-tree",attrs:{"check-strictly":e.checkStrictly,data:e.dialogData.treeData.apiData,props:e.defaultProps,"show-checkbox":"","node-key":"id","default-checked-keys":e.handleChoiceApiDataPermissionID,"filter-node-method":e.filterApiNode}})],1)]):e._e(),e._v(" "),"edit"===e.dialogType?a("el-form-item",{attrs:{label:"页面权限"}},[a("div",{})]):e._e()],1),e._v(" "),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("Cancel")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmFun}},[e._v("Confirm")])],1)],1)],1)},i=[],r=(a("8e6e"),a("456d"),a("ac4d"),a("8a81"),a("1c4c"),a("6b54"),a("bd86")),o=(a("5df3"),a("75fc")),c=(a("7f7f"),a("ac6a"),a("96cf"),a("3b8d")),l=(a("7514"),a("6762"),a("2fdb"),a("df7c")),s=a.n(l),u=a("cc5e"),d=a("d408");function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=g(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i,r=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return r=e.done,e},e:function(e){o=!0,i=e},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw i}}}}function g(e,t){if(e){if("string"===typeof e)return m(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var b={id:"",name:"",filterApiText:""},D={components:{ChoiceRole:d["a"]},data:function(){return{list:[],dialogVisible:!1,dialogType:"new",dialogData:{data:this._.cloneDeep(b),treeData:{choiceApiDataAdd:[],choiceApiDataDel:[],choiceApiDataOld:[],choiceApiData:[],apiData:[],choicePageData:[],pageData:[]}},checkStrictly:!1,defaultProps:{children:"children",label:"label"}}},computed:{handleChoiceApiDataID:function(){return this.dialogData.treeData.choiceApiData.map((function(e){return e.id}))},handleChoiceApiDataPermissionID:function(){return this.dialogData.treeData.choiceApiData.map((function(e){return e.permission_id}))}},watch:{"dialogData.data.filterApiText":function(e){this.$refs.apitree.filter(e)}},created:function(){this.getList(),this.getAllApiTree()},methods:{filterApiNode:function(e,t){return!e||t.label.includes(e)},checkApiTree:function(e,t,a){var n=this.handleChoiceApiDataPermissionID,i=this.dialogData.treeData.choiceApiData,r=i.find((function(t){return t.permission_id===e.id})),o=null===r||void 0===r?void 0:r.id;t?(this.dialogData.treeData.choiceApiDataAdd.includes(e.id)||n.includes(e.id)||this.dialogData.treeData.choiceApiDataAdd.push(e.id),this.dialogData.treeData.choiceApiDataAdd.includes(o)&&(this.dialogData.treeData.choiceApiDataDel=this.dialogData.treeData.choiceApiDataDel.filter((function(e){return e!==o})))):(this.dialogData.treeData.choiceApiDataDel.includes(o)||r&&this.dialogData.treeData.choiceApiDataDel.push(o),this.dialogData.treeData.choiceApiDataAdd.includes(e.id)&&(this.dialogData.treeData.choiceApiDataAdd=this.dialogData.treeData.choiceApiDataAdd.filter((function(t){return t!==e.id}))))},renderContent:function(e,t){var a=this,n=t.node,i=t.data;t.store;return e("span",{class:"custom-tree-node"},[e("span",[n.label]),e("span",[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return a.append(i)}}},["Append"]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return a.remove(n,i)}}},["Delete"])])])},getAllApiTree:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["f"])();case 2:t=e.sent,a=t.data,this.dialogData.treeData.apiData=this.generateApi(a);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),generateApi:function(e){var t=[];return e.forEach((function(e){var a={id:e.id,content:e.content,name:e.name,status:e.status,label:"".concat(e.content,"(").concat(e.name,")")};t.push(a)})),t},changeRoleStatus:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["i"])(t);case 2:a=e.sent,this.$notify({title:"Success",message:a.info,type:"success"});case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getRoutes:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["h"])();case 2:return t=e.sent,e.abrupt("return",this.generateRoutes(t.data));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getList:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["g"])();case 2:t=e.sent,a=t.data,this.list=a;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),generateRoutes:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",n=[],i=p(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(!r.hidden){var o=this.onlyOneShowingChild(r.children,r);r.children&&o&&!r.alwaysShow&&(r=o);var c={path:s.a.resolve(a,r.path),title:r.title,name:r.name};r.children&&(c.children=this.generateRoutes(r.children,c.path)),n.push(c)}}}catch(l){i.e(l)}finally{i.f()}return n},generateArr:function(e){var t=this,a=[];return e.forEach((function(e){if(a.push(e),e.children){var n=t.generateArr(e.children);n.length>0&&(a=[].concat(Object(o["a"])(a),Object(o["a"])(n)))}})),a},handleDelete:function(e){var t=this;this.$confirm("Confirm to remove the role?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(Object(c["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(u["d"])(e.row.id);case 2:t.list.splice(e.$index,1),t.$message({type:"success",message:"Delete succed!"});case 4:case"end":return a.stop()}}),a)})))).catch((function(e){console.error(e)}))},generateTree:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",n=arguments.length>2?arguments[2]:void 0,i=[],r=p(e);try{for(r.s();!(t=r.n()).done;){var o=t.value,c=s.a.resolve(a,o.path);o.children&&(o.children=this.generateTree(o.children,c,n)),(n.includes(c)||o.children&&o.children.length>=1)&&i.push(o)}}catch(l){r.e(l)}finally{r.f()}return i},clearDialogDataCache:function(){console.log("clearDialogDataCache"),this.dialogData.data=this._.cloneDeep(b),this.$refs.apitree.setCheckedKeys([])},handleAdd:function(){this.$refs.tree&&this.$refs.tree.setCheckedNodes([]),this.dialogType="new",this.dialogVisible=!0},handleEdit:function(e){var t=this;this.dialogType="edit",this.dialogVisible=!0,this.checkStrictly=!0,this.$nextTick(Object(c["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.clearDialogDataCache(),a.next=3,Object(u["e"])({role_id:e.row.id});case 3:n=a.sent,i=n.data,t.dialogData.data=t._.cloneDeep(e.row),t.dialogData.treeData.choiceApiData=i,t.checkStrictly=!1;case 8:case"end":return a.stop()}}),a)}))))},getChoiceApiDataAdd:function(e){var t=this,a=Object(o["a"])(e),n=[];return a.forEach((function(e){t.handleChoiceApiDataPermissionID.includes(e)||n.push(e)})),n},getChoiceApiDataDel:function(e){var t=Object(o["a"])(e),a=[];return this.dialogData.treeData.choiceApiData.map((function(e){t.includes(e.permission_id)||a.push(e.id)})),a},confirmFun:function(){var e=this,t="edit"===this.dialogType;if(t){var a=this.$refs.apitree.getCheckedKeys();Promise.all([Object(u["a"])({role_id:this.dialogData.data.id,role_pms:this.getChoiceApiDataAdd(a).join()}),Object(u["c"])({role_id:this.dialogData.data.id,ids:this.getChoiceApiDataDel(a).join()})]).then((function(t){e.$notify({title:"Success",message:t.info,type:"success"})})).catch((function(e){console.log(e)})).finally((function(t){e.dialogVisible=!1}))}else Promise.all([Object(u["b"])(this.dialogData.data),this.getList()]).then((function(t){e.$notify({title:"Success",message:t.info,type:"success"})})).catch((function(e){console.log(e)})).finally((function(t){e.dialogVisible=!1}))},onlyOneShowingChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=null,n=e.filter((function(e){return!e.hidden}));return 1===n.length?(a=n[0],a.path=s.a.resolve(t.path,a.path),a):0===n.length&&(a=f(f({},t),{},{path:"",noShowingChildren:!0}),a)}}},v=D,y=(a("f16c"),a("2877")),w=Object(y["a"])(v,n,i,!1,null,"b0a210f0",null);t["default"]=w.exports},c12d:function(e,t,a){},cc5e:function(e,t,a){"use strict";a.d(t,"h",(function(){return i})),a.d(t,"g",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"i",(function(){return c})),a.d(t,"d",(function(){return l})),a.d(t,"f",(function(){return s})),a.d(t,"e",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return h}));var n=a("b775");function i(){return Object(n["a"])({url:"/vue-element-admin/routes",method:"get"})}function r(){return Object(n["a"])({url:"/group/get-role-list",method:"get"})}function o(e){return Object(n["a"])({url:"/group/create-role",method:"post",data:e})}function c(e){return Object(n["a"])({url:"/group/edit-role-status",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/group/del-role",method:"post",data:{id:e}})}function s(){return Object(n["a"])({url:"/permission/get-pms-list",method:"get"})}function u(e){return Object(n["a"])({url:"/role-permission/get-role-pms-list",method:"get",data:e})}function d(e){return Object(n["a"])({url:"/role-permission/add-role-pms",method:"post",data:e})}function h(e){return Object(n["a"])({url:"/role-permission/del-role-pms",method:"post",data:e})}},d408:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-select",{staticClass:"role-select",attrs:{placeholder:"请选择role",disabled:e.disabled},on:{change:e.changeRole},model:{value:e.choiceRole,callback:function(t){e.choiceRole=t},expression:"choiceRole"}},e._l(e.rolesList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)},i=[],r=(a("96cf"),a("3b8d")),o=a("cc5e"),c={name:"ChoiceRole",props:{role:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{choiceRole:"",rolesList:[]}},watch:{role:{handler:function(e,t){this.choiceRole=e},immediate:!0}},mounted:function(){this.getRoles()},methods:{getRoles:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["g"])();case 2:t=e.sent,this.rolesList=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),changeRole:function(){this.$emit("update:role",this.choiceRole)}}},l=c,s=(a("e553"),a("2877")),u=Object(s["a"])(l,n,i,!1,null,"55d64b78",null);t["a"]=u.exports},e553:function(e,t,a){"use strict";var n=a("c12d"),i=a.n(n);i.a},f16c:function(e,t,a){"use strict";var n=a("4343"),i=a.n(n);i.a}}]);